<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Food Ordering Site</title>
<link rel="stylesheet" href="css/font-awesome.min.css">
<link href="css/layout.css" type="text/css" rel="stylesheet">
<link href="css/style.css" type="text/css" rel="stylesheet">
	<link rel='icon' href="favicon.ico?v=3" sizes="16x16">
<link href='https://fonts.googleapis.com/css?family=Roboto:400,500,700' rel='stylesheet' type='text/css'>
<link href="https://fonts.googleapis.com/css?family=Dancing+Script" rel="stylesheet">
	<script src="js/js.cookie.js"></script>
	<script src="//cdn.jsdelivr.net/alertifyjs/1.8.0/alertify.min.js"></script>
	<!-- CSS -->
	<link rel="stylesheet" href="//cdn.jsdelivr.net/alertifyjs/1.8.0/css/alertify.min.css"/>
	<!-- Default theme -->
	<link rel="stylesheet" href="//cdn.jsdelivr.net/alertifyjs/1.8.0/css/themes/default.min.css"/>
	<link rel="stylesheet" href="css/font-awesome.min.css">
</head>

<body id="prchsd-dtl">
<div class="sec-header">
	<div class="container pad15 tcenter posrel">
		<h2 class="logo_black fL">
	    	<a href="/"><img src="images/logo_black.png" alt="logo_name"></a>
	    </h2>	    
	    <!--<ul class="rgt-menu fR tright">	    	-->
	        <!--<li><em>Hi <strong>abcasd@gmail.com</strong></em></li>-->
	        <!--<li><span class="dpInblk vam logout">Logout</span></li>-->
	    <!--</ul>-->
	    <div class="clear fN"></div>
    </div>    
</div>
<div class="prchsd-dtl-wrpr">
	<div class="container">
		<div class="dpTable top-prt">
			<div class="dpTblcl vam tleft">
				<p class="themecolor2 t14"><span>Order</span><span id="orderid"></span></p>
				<p class="clear5"></p>
				<!--<p class="tgreydark t12">The Crispy Bites</p>-->
			</div>
			<div class="dpTblcl vam tright">
				<p class="themecolor2 t14">Got Question?</p>
				<p class="clear5"></p>
				<p class="tgreydark t12">Call Us: 9386668666</p>
			</div>
		</div>
		<div class="prchsd-dtl dpTable">
			<div class="lft-pane dpTblcl vat">
				<div class="item-dtl tgreydark t13">
					<p class="thead tbold">
						<span>Item Name</span>
						<small>Quantity</small>
						<font>Total</font>
					</p>
					<div id="dishlist">

					</div>

					<div class="hr"></div>					
					<div class="pad15 tgreylight t14 tright dpTable">
						<div class="dpTblcl vam"> Discount: &nbsp; &nbsp; &nbsp; <span id="off_amount">&#8377; 0</span></div>
					</div>
					<div class="pad15 tgreylight t14 tright dpTable">
						<div class="dpTblcl vam"> TAX: &nbsp; &nbsp; &nbsp; <span id="tax_amount">&#8377; 0</span></div>
					</div>
					<div class="hr"></div>					
					<div class="pad15 t14 dpTable">
						<div class="dpTblcl tgreylight vam tleft" id="payment_mode">Mode of Payment: payment_mode</div>
						<div class="dpTblcl vam tgreydark tright">Grand Total: &nbsp; &nbsp; &nbsp; <span id="total_price">180</span></div>
					</div>
					<div class="hr nomarginbottom"></div>
				</div>
				<!-- <div class="map-wrpr">
					<div id="map"></div>
					<div class="map-overlay">
						<p>You can start tracking your order in few mins.</p>
					</div>
				</div> -->
			</div>
			<div class="rgt-pane dpTblcl vat">
				<div class="track-ordr">
					<div class="box default" id="order_confirmed">
						<p class="thead">Order Received</p>
						<p class="clear10"></p>
						<div class="t12 tgreydark adrs">
							<p>Delivery Address</p>
							<div class="hr"></div>
							<p id="address"></p>
						</div>
					</div>
					<div class="box" id="order_prepared">
						<p class="thead">Arrived at Restaurant</p>						
					</div>
					<div class="box" id="order_dispatched">
						<p class="thead">Order Prepared</p>
					</div>
					<div class="box" id="order_delivered">
						<p class="thead">Out For Delivery</p>
						<p class="clear10"></p>
						<div class="t12 tgreydark exctv">
							<span class="dpInblk" id="delivery_person_alloted"></span><br/>
							<span class="dpInblk" id="delivery_person_contact"></span>
						</div>
					</div>
					<div class="box dlvrd">
						<p class="thead">Order Delivered</p>						
					</div>					
				</div>
			</div>			
		</div>
	</div>
</div>
<!-- footer -->
<footer class="footer">
    <div class="container">
        <div class="top-row tcenter">
            <p class="tbold t18">Premium Support</p>
            <p class="clear20"></p>
            <p>Our customer support lines are open from 12 PM to 11:15 PM, Monday to Sunday. </p>
            <p>You can call us at : <strong>+91-9386668666</strong></p>
            <p class="clear20"></p>
            <p>For Customer queries : Mail us at <a href="mailto:care@zasty.co">care@zasty.co</a></p>            
            <p class="clear60"></p>
        </div>
        <div class="btm-footer tcenter">
            <div class="useful-links-wrpr">
                <h4 class="t18">Policies</h4>
                <ul>
                    <li><a href="#">Terms and Conditions</a></li>
                    <li><a href="#">Privacy and Policies</a></li>
                    <li><a href="#">Delivery and Shipping</a></li>
                    <li><a href="#">Payment Policy</a></li>
                    <li><a href="#">Returns and Cancelations</a></li>
                </ul>
            </div>
            <div class="reg">
                <h2 class="logo_black nomargin">
                    <a href="#" class="dpInblk"><img src="images/logo_black.png" alt="logo_name"></a>
                </h2>
                <div class="clear20"></div>
                <h3 class="nomargin">&copy; 2016 Zasty Technologies Pvt Ltd</h3>
                <p class="t12">All Rights Reserved</p>
            </div>
            <div class="social-icons-wrpr">
                <h4 class="t18">Social Media</h4>
                <ul>
                    <li class="fb"><a href="https://www.facebook.com/zasty.co/"><i class="fa fa-facebook-official"></i></a></li>
                    <li class="insta"><a href="https://www.instagram.com/zasty.co/"><i class="fa fa-instagram"></i></a></li>
                    <li class="twitt"><a href="https://twitter.com/ZastyCo"><i class="fa fa-twitter"></i></a></li>
                    <!-- <li class="linkedin"><a href="#"><i class="fa fa-linkedin"></i></a></li>
                    <li class="gp"><a href="#"><i class="fa fa-google-plus"></i></a></li> -->
                </ul>
            </div>
            <p class="fN clear"></p>
        </div>
    </div>
</footer>
<!-- map -->
<script>
 Cookies.remove('cart');
// cart = {};
</script>
<script src="js/jq-min.js" type="text/javascript"></script>
<script src="js/jq-ui.js" type="text/javascript"></script>
<script src="js/functions.js" type="text/javascript"></script>
<script src="js/custom.js" type="text/javascript"></script>
<script>
	var queryDict = {}
	$(document).ready(function () {
		window.location.search.substr(1).split("&").forEach(function(item) {queryDict[item.split("=")[0]] = item.split("=")[1]});
		console.log(queryDict.orderid);
		$("#orderid").html(" #"+queryDict.orderid);
		getdetails();
		setInterval(getdetails,5000)
	})
	function getdetails(){
		$.ajax({
			url: config.server_url + '/api/v1/order/details?id='+queryDict.orderid,
			headers: {
				'Content-Type': 'application/json'
			},
			type: 'GET',
			dataType: "json",
			success: function (json) {
				console.log(json);
				var disheshtml=""
				var price_sum=0;
				for(var i=0;i<json.dishes.length;i++){
					disheshtml=disheshtml+	"<p>"+
							"<span>"+json.dishes[i].name+"</span>"+
							"<small>"+json.dishes[i].qty+"</small>"+
							"<font>&#8377; "+json.dishes[i].price+"</font>"+
							"</p>"
					price_sum=price_sum+Number(json.dishes[i].price);
				}
				$("#dishlist").html(disheshtml);
				$("#total_price").html(json.total);
				$("#tax_amount").html(Math.round(price_sum*0.15));
				if(json.off){
					$("#off_amount").html("-"+Math.round(price_sum*(json.off)/100));
				}
				$("#payment_mode").html("Mode of Payment: "+json.mode);
				console.log(json.delivery_person_alloted);
				$("#delivery_person_alloted").html(json.delivery_person_alloted);
				$("#delivery_person_contact").html(json.delivery_person_contact);
				$("#address").html(json.address+","+json.area+","+json.city);
				if(json.status==2){
					$("#order_confirmed").addClass("a-start");
				}else if(json.status==3){
					$("#order_confirmed").addClass("a-start");
					$("#order_prepared").addClass("a-start");
				}else if(json.status==4){
					$("#order_confirmed").addClass("a-start");
					$("#order_prepared").addClass("a-start");
					$("#order_dispatched").addClass("a-start");
				}else if(json.status==5){
					$("#order_confirmed").addClass("a-start");
					$("#order_prepared").addClass("a-start");
					$("#order_dispatched").addClass("a-start");
					$("#order_delivered").addClass("a-start");
				}
			},
			error: function (xhr, _status, errorThrown) {
				console.log("err: ", {status: _status, err: errorThrown, xhr: xhr});

			}
		});
	}

</script>
</body>
</html>